<form id="uploadForm">
  <input type="file" id="fileInput" name="file" multiple />
  <button type="submit">Subir</button>
</form>
<progress id="progressBar" value="0" max="100"></progress>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbytx4ILKKH3_OYxsNoo7rdAI0ZC02u-4LyuYV4VPDKjqR4Q_BIzc6DhL2J8CCqxjMMg/exec"; // Ejemplo: https://script.google.com/macros/s/AKfycby.../exec

document.getElementById("uploadForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  
  const files = document.getElementById("fileInput").files;
  const progressBar = document.getElementById("progressBar");
  let formData = new FormData();
  
  for (let i = 0; i < files.length; i++) {
    formData.append(`file${i}`, files[i]);
  }

  try {
    const response = await fetch(scriptURL, {
      method: "POST",
      body: formData,
    });

    const result = await response.json();
    alert("Archivos subidos correctamente!");
  } catch (error) {
    alert("Error de red o de servidor: " + error.message);
  }
});
</script>
